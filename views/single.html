{% extends 'layout.html' %}
{% block content %}
<wired-card class="entire_single" elevation="5" >
    <h3 class="alone">싱글 게임</h3>
    <div class="hint">
        <textarea class="first_line container" disabled elevation="5"></textarea>
        <textarea class="first_line container" disabled elevation="5"></textarea>
    </div>

    <div class="hint">
        <textarea class="first_line container" disabled elevation="5"></textarea>
        <textarea class="first_line container" disabled elevation="5"></textarea>
    </div>

    <div class="who">
        <wired-card class="second_line" elevation="5"><span>누구일까요?</span></wired-card>
        <wired-button elevation="3">확인</wired-button>
        <wired-input type="text" name="title" placeholder="챔피언 입력"> 
    </div>

    <div class="exit">
        <wired-dialog-demo>
            <wired-button elevation="3" id="lobby">로비로 돌아가기</wired-button>
            <wired-dialog class="hidden" open>
                <div id="appear" >
                    <p>정말 나가실건가요?</p>
                    <wired-button id="go_out" onclick="location.href='/'">나가기</wired-button>
                    <wired-button id="leave">계속 하기</wired-button>
                </div>
                
            </wired-dialog>
        </wired-dialog-demo>
    </div>
</wired-card>
{% endblock %}
{% block script %}
<script>
	const socket = io.connect('http://localhost:3000/single', {
		path: '/socket.io',
	});

	// 문제 가져옴
	socket.emit('make');
	socket.on('get', function(data) { 
		const hintcard = document.querySelectorAll('.hint textarea');
		for(let i=0; i< 4;i++){
			hintcard[i].innerHTML = data[i].content;
		}
  	});

	// 확인 버튼
	function addConfirmEvent(e) {
		e.preventDefault();
		const insertedAnswer = document.querySelector('wired-input').value;
		console.log('확인버튼 누름');
		socket.emit('correct', insertedAnswer);
		socket.on('correct', function(data) {
			if(data === 'corrected'){
				socket.emit('make');
			}
			else {
				socket.emit('out');
			}
		})
	}
	const btn = document.querySelector('wired-button');
	btn.addEventListener('click', addConfirmEvent);	

    const button = document.getElementById("lobby");
    const dialog = document.querySelector("wired-dialog");
    const leave = document.getElementById("leave");
    const go_out = document.getElementById("go_out");

    button.addEventListener("click" , () => {
        dialog.classList.remove("hidden");
    });

    leave.addEventListener("click" , () => {
        dialog.classList.add("hidden");
    });
</script>
{% endblock %}